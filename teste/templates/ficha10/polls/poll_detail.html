{% extends 'ficha10/base.html' %}
{% block title %}{{ poll.question }}{% endblock %}
{% block content %}
<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="bg-white rounded-lg shadow-md p-8">
        <h1 class="text-3xl font-bold mb-4">{{ poll.question }}</h1>
        <p class="text-gray-600 mb-6">Criado por {{ poll.created_by_user_id.username }} â€¢ {{ poll.created_at|date:"d/m/Y" }}</p>
        
        {% if not user_vote and poll.is_active %}
        <form method="post" action="{% url 'ficha10:vote_poll' poll.poll_id %}" class="space-y-4 mb-8">
            {% csrf_token %}
            {% for option in options %}
            <label class="flex items-center p-4 border rounded-lg hover:bg-gray-50 cursor-pointer">
                <input type="radio" name="option_id" value="{{ option.option_id }}" class="mr-3">
                <span class="text-lg">{{ option.option_text }}</span>
            </label>
            {% endfor %}
            <button type="submit" class="w-full px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                <i class="fas fa-vote-yea mr-2"></i>Votar
            </button>
        </form>
        {% else %}
        <div class="mb-8">
            <h3 class="font-bold text-lg mb-4">Resultados ({{ total_votes }} votos)</h3>
            {% for option in options %}
            <div class="mb-4">
                <div class="flex justify-between mb-1">
                    <span>{{ option.option_text }}</span>
                    <span class="font-bold">{{ option.vote_count }} ({% widthratio option.vote_count total_votes 100 %}%)</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div class="bg-purple-600 h-3 rounded-full" style="width: {% if total_votes > 0 %}{% widthratio option.vote_count total_votes 100 %}{% else %}0{% endif %}%"></div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
